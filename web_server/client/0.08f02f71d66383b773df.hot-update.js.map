{"version":3,"file":"0.08f02f71d66383b773df.hot-update.js","sources":["/home/horis/Documents/News-Recommend-Project/web_server/client/src/NewsPanel/NewsPanel.js"],"sourcesContent":["import React from 'react';\nimport './NewsPanel.css';\nimport NewsCard from '../NewsCard/NewsCard';\nimport _ from 'lodash';\nimport Auth from '../Auth/Auth';\n\n\n\nclass NewsPanel extends React.Component {\n  constructor() {\n    super();\n    this.state = { news: null, pageNum:1, totalPages:1, loadedAll:false };\n  }\n\n  handleScroll() {\n    const scrollY = window.scrollY\n        || window.pageYOffset\n        || document.documentElement.scrollYTop;\n    if ((window.innerHeight + scrollY) >= (document.body.offsetHeight - 50)) {\n      this.loadMoreNews();\n    }\n  }\n\n  componentDidMount(){\n    this.loadMoreNews();\n    this.loadMoreNews = _.debounce(this.loadMoreNews, 1000);\n    window.addEventListener('scroll', () => this.handleScroll());\n  }\n\n  loadMoreNews() {\n    if (this.state.loadedAll === true) {\n      return;\n    }\n    const url = 'http://' + window.location.hostname + ':3000' + '/news';\n    let request = new Request(encodeURI(url), {\n      method: 'GET',\n      headers: {\n        'Authorization': 'bearer ' + Auth.getToken(),\n      }\n    });\n\n\n    fetch(request)\n      .then(res => res.json())\n      .then(news => {\n        if (!news ||  news.length === 0) {\n          this.setState({loadedAll: true});\n        }\n        this.setState({\n          news: this.state.news ? this.state.news.concat(news) : news,\n          pageNum: this.state.pageNum + 1\n        });\n      });\n  }\n\n  renderNews() {\n    const news_list = this.state.news.map(news => {\n      return (\n        <a className = 'list-group-item' key = {news.digest} >\n          <NewsCard news = {news} />\n        </a>\n      );\n    });\n\n    return (\n      <div className = 'container-fluid'>\n        <div className = \"list-group\">\n          {news_list}\n        </div>\n      </div>\n    );\n  }\n\n  render() {\n    if (this.state.news) {\n      return(\n        <div>\n          {this.renderNews()}\n        </div>\n      );\n    } else {\n      return(\n        <div>\n          Loading...\n        </div>\n      );\n    }\n  }\n}\n\nexport default NewsPanel;\n\n\n\n// WEBPACK FOOTER //\n// src/NewsPanel/NewsPanel.js"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAGA;;;AACA;AAAA;AACA;AADA;AACA;AACA;AAFA;AAGA;AACA;;;AACA;AACA;AAGA;AACA;AACA;AACA;;;AAEA;AAAA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AACA;;;AAEA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAFA;AACA;AAOA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;;;AAEA;AAAA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAIA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AADA;AAMA;;;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAIA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;;;;AA/EA;AACA;AAiFA;;;;A","sourceRoot":""}